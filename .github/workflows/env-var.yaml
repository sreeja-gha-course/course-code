name: Environment variables and workflow
on: [push]
env: 
    WF_LEVEL_ENV: "Available to all jobs"
jobs:
    env-vars-context:
        runs-on: ubuntu-latest
        if: github.ref == 'refs/heads/main'
        env:
            JOB_LEVEL_ENV: "available to all steps in the job"
        steps:
            - name: Log ENV VAR
              run: echo $GITHUB_REF
            - name: Log Context
              run: echo '${{ github.ref }}'
            - name: Set ENV var
              run: |
                echo "NEW_ENV_VAR=$(date)" >> "$GITHUB_ENV"  # this value writes into GITHUB_ENV file in runner machine
                echo "JOB_LEVEL_ENV=$RANDOM" >> "$GITHUB_ENV"
            - name: Multi line-string
              run: |
                DELIMETER=1234
                echo "RANDOM_JOKE <<$DELIMETER" >> "$GITHUB_ENV"
                echo "HEre is a joke" >>"$GITHUB_ENV"
                echo "JUST for fun there is no joke" >> "$GITHUB_ENV"
                echo "$DELIMETER" >> "$GITHUB_ENV"
            - name: Log custom ENV vars
              #if: github.ref == 'refs/heads/main'
              env:
                STEP_LEVEL_ENV: "Availableonly to step"
                WF_LEVEL_ENV: "overridden in step"
              run: |
                echo '${{ env.STEP_LEVEL_ENV }}'
                echo $STEP_LEVEL_ENV
                echo $WF_LEVEL_ENV
                echo $JOB_LEVEL_ENV